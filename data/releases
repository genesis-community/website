{
  "all": [
    {
      "notes": "# Updates\n\n-Can now update subject, SAN, and usage of vault-stored certificates without generating a new key with genesis rotate-secrets --renew\n This allows users to correct warnings that show up in the check during deployment without breaking mutual TLS.\n (Note this will also renew the TTL for the certificates)\n",
      "url": "https://github.com/starkandwayne/genesis/releases/tag/v2.7.31",
      "version": "2.7.31"
    },
    {
      "notes": "# Updates\n\n- credhub-cli is now a requirement. A check for credhub-cli has been added \n jq v1.6 is now the minimum version required. \n",
      "url": "https://github.com/starkandwayne/genesis/releases/tag/v2.7.32",
      "version": "2.7.32"
    },
    {
      "notes": "# New Feature\n\n* Add `update` genesis command to get new version\n\n  Usage: genesis update [-c|--check] [-v|--version VERSION] [-d|--details] [-f|--force]\n\n    -c, --check       Check if a newer version (or the specified version) is\n                      available.\n\n    -v, --version <x> Install the specified version instead of the latest\n\n    -d, --details     Print the release notes of the versions between the current\n                      version and the latest (or the release notes of the\n                      specified version)\n\n    -f, --force       Replace the current genesis executable.  Otherwise,\n                      confirmation will be requested.\n\n# Improvements\n\n* Improve `genesis kit-provider -v` status output\n\n* Improve `genesis list-kits` hint to include -r flag.\n\n* Make it easier to trace the stack\n\n  Adds the -S|--show-stack debug option, and gives better context of traces\n  and errors.\n\n  Behaviour Changes:\n\n  - internal `trace` output will show the location in the code were it was\n    called. If --show-stack option specified, it will show the full stack\n    instead of just the location.\n\n  - internal `dump_vars` output will now show the full stack instead of\n    just the calling location if --show-stack specified (along with\n    --trace or --debug)\n\n  - internal `bail` will show calling location if --trace or --debug is\n    specified, or the full stack if --show-stack is specified (with or\n    without --debug or --trace).  This allows you to see where genesis\n    terminates without wading through all the trace output.\n\n  - internal `bug` will always full stack where the bug was encountered.\n    This allows the user to paste the stack into a defect report against\n    the genesis project.\n\n* Limited false positives of detected changes in pipeline notify summaries. \n\n# Bug Fixes\n\n* Fix getting non-production github release version\n\n  If user specified version by name, it should include draft and\n  prereleases when looking for it.  This was the initial intent, but the\n  wrong options were set when attempting it.\n\n* Fix error when calling `genesis man` on a kit that does not exist.\n\n* Fixes issue where proto-bosh deployment did not have up to date state file.\n",
      "url": "https://github.com/starkandwayne/genesis/releases/tag/v2.7.32",
      "version": "2.7.33"
    },
    {
      "notes": "# Improvements\n\n* `genesis init` can now accept a local compiled kit file as an argument to the `-k` option, allowing locally compiled (or stored) released kit files instead of relying on the local uncompiled `dev` directory.\n\n# Requirement Updates\n\n* BOSH CLI v6.4.4 is now required due to error when accessing non-bosh.io stemcells that are now being specified by upstream deployments.\n\n# Bug Fixes\n\n* `genesis kit-manual` now works on dev kits, or environments that use dev\n  kits\n",
      "url": "https://github.com/starkandwayne/genesis/releases/tag/v2.7.34",
      "version": "2.7.34"
    },
    {
      "notes": "# Bug Fix\n\n* Update Genesis bosh activities to work with BOSH cli v6.4.4\n\n  As of BOSH cli 6.4.4, BOSH_* variables set to \"\" cause errors, so now they are simply unset.\n",
      "url": "https://github.com/starkandwayne/genesis/releases/tag/v2.7.35",
      "version": "2.7.35"
    },
    {
      "notes": "# New Features\n\n* Auto-connect to BOSH director.\n\n  Genesis can now automatically connect to the correct BOSH director for the\n  specified environment, without need to set up a bosh configuration or\n  manually logging into the director.\n\n  Caveat: The BOSH director that deployed your environment MUST have been\n  deployed by Genesis.  If not, you will still have to target and log into the\n  BOSH director manually.\n\n* Added `genesis bosh` command.\n\n  Instead of worrying about logging into the right BOSH director, and\n  translating genesis environment into BOSH environment and deployment, let\n  Genesis do the heavy lifting.\n\n  If you want to know something about your concourse vms, for example, you\n  just run `genesis bosh my-concourse-env vms --vitals` and you'll get the\n  right output.  Genesis will determine which bosh director deployed\n  `my-concourse-env`, how to connect to it, what the BOSH deployment is named,\n  and return the results of the command you specified.\n\n  By default, the `genesis bosh` command is deployment centric, but sometimes\n  you need to talk to the BOSH director itself.  In that case, you can specify\n  the BOSH deployment itself, and use the `-as-director` (or `-A`) option to\n  indicate that the environment is the director, not a deployment on a\n  different director.  For proto-BOSH environments, this is required.\n\n  See `genesis bosh -h` for more usage details.\n\n* Connect to BOSH director without using the BOSH deployment kit.\n\n  If you still need to connect to a BOSH director directly, you can configure\n  your shell by using `eval \"$(genesis bosh my-target-env --connect)\"`.\n  Please note that this connects to the BOSH director that deployed the\n  `my-target-env`.  If `my-target-env` is a bosh deployment, the command will\n  authenticate to the BOSH director that deployed it, not itself.  In this\n  case, you need to use the `--as-director` option to explicitly state that\n  this is the BOSH environment you wish to connect to.\n\n# Breaking Changes\n\n* Removes legacy support for kits without new or blueprint.\n\n  As of v2.8.0, kits must use new and blueprint hooks.  All modern kits\n  support this model, so anyone actively keeping current with genesis would\n  not be impacted.\n\n* Remove subkits, error if used in env file.\n\n  Subkits have been deprecated since at least 2.6.13, so its time to remove\n  them.\n\n* Remove `--environment` global option.\n\n  The environment option has been replaced with `--bosh-env` option to remove\n  confusion regarding the overloaded 'environment' name.  Henceforth,\n  environment refers to just the deployment environment.  The `-e` shortform\n  is still usable.\n\n# Improvements\n\n## Better Support for using BOSH create-env\n\n  * Starting in v2.8.0, kits that indicate that they are compatible with\n    v2.8.0 can support `use_create_env` as their method of indicating\n    their ability to use create-env instead of deploy for deployments.\n\n    - Valid values are `yes` for this kit always uses create-env, `no` for\n      kits that cannot use create-env, and `allow` for kits that permit\n      either.\n\n    - The kit will have to detect `genesis.use_create_env` in the\n      environment to determine blueprint and other create-env kit\n      behaviour.  Genesis will manage the actual deployment and state file\n      associated with it.\n\n  * Genesis properly handles both legacy features (create-env,bosh-init,\n    proto) and v2.8.0's `genesis.use_create_env` attribute to determine is\n    create-env is to be used.  It will also detect when an incompatible\n    mixture of using create-env and specifying a `genesis.bosh-env`\n    attribute, and fail with an appropriate error message.  A quick update\n    of the environment file by the user will resolve this issue when\n    encountered.\n\n* Provide create-env (i.e.: bosh proto) deployments with diff/confirm\n\n  Since BOSH does not provide a confirmation after a diff on the\n  environment to be deployed, Genesis provides this based on a previous\n  deployment, assuming it was added to the repo.\n\n  If the exodus data from the previous deployment doesn't match the local\n  archived manifest, a warning will be stated, or in the case of running\n  under `-y`, the deploy will be aborted.\n\n  This does require that you ensure you commit your repo after doing \n  deployments, which you should be doing regardless of this feature, as\n  a method to record your deployment history. \n\n## Kit Overrides by Environment\n\n  * Environments can now customize kit behaviour directly, by specifying a\n    `overrides` parameter under the top-level `kit` attribute.  This\n    replaces the repo-wide `kit-overrides.yml` file (though it is still\n    supported.\n\n    This improves the previous behaviour because environments can target\n    different versions of a kit, meaning the one-file-fits-all can be\n    sub-optimal or even broken.  It also means the overrides can propagate\n    through the repo using hierarchical inheritance.\n\n    It comes in three forms:\n\n    - Simple string: By placing the overrides (in yml form) inside a\n      string block, it is applied verbatim. Any spruce operators will be\n      applied to the kits kit.yml only.\n\n      ```\n      kit:\n        overrides: |\n          docs: \"https://internal-docs-for-kit.mycorp.com\"\n          genesis_version_min: 2.8.0\n          use_create_env: yes\n      ```\n\n    - Simple YAML hashmap:  By using a hash-map, you can use spruce\n      operators to take values from the environment yaml hierarchy (though\n      not the full manifest, as that would be a chicken/egg issue with the\n      kit itself).  If you want to use spruce operators against values in\n      the kits `kit.yml` file, use the `defer` operator in front:\n\n      ```\n      kit:\n        overrides:\n          credentials:\n            base:\n              my-secret: (( grab params.my-secret )) # from env.yml\n              old-secret: (( defer concat credentials.base.secret \"-disabled\" )) # from kit.yml\n      ```\n\n    - Array of the above types: By permitting an array, you can apply the\n      changes in layers, or build from hierarchical ancestors\n\n      ```\n      kit:\n        overrides:\n        - |\n          first_stuff: 1\n\n        - second:\n            stuff: also\n\n      ```\n\n      And in an inheritting file:\n\n      ```\n      kit:\n        overrides:\n        - (( append ))\n        - second:\n            stuff: overwritten\n        - |\n          even_more: true\n        ```\n\n## Improved Kit Behaviour\n\n* Improve params handling for use in `new` hook.\n\n  - Support multiline values in keys and arrays in `param_entry`.\n\n  - Echo `param_comment` to screen so the same information that prefaces the\n    value in the env.yml file can be used as an explanatory blurb prior to the\n    prompt.\n\n* Improve decompile-kit\n\n  - Can decompile kit to directories other than ./dev (`--directory <dir>`)\n\n  - Can specify an environment YAML file to identify which kit to decompile,\n    instead of explicitly stating the kit/version.\n\n## Better BOSH Config Management\n\n* Support downloading multiple configs.\n\n  Before, if you specified to download a config type (ie cloud or runtime)\n  without a name, it would download only the unnamed *default* config of that\n  type.  Experience has shown that the more correct interpretation should be\n  to download all configs of that type, and merge them (in the order they are\n  specified in the BOSH director).  The old behaviour can still be used by\n  explicitly stating `default` as the name.\n\n## Messaging / Error Handling / Debugging\n\n* Added stderr output capture for `Genesis::Vault#get`.\n\n  Rather than have the raw safe stderr leak out to the user, we now capture it\n  and write it to the DEBUG stream.\n\n* Improve deploy help output for create-env environments\n\n  There are difference behaviours for create-env environment than from\n  environments deployed via a BOSH director.  This update calls them out\n  and gives instructions on their use.\n  \n* Improved error message when kit.features is incorrectly formed in environment YAML files.\n\n* Better diagnosis messages when running PING in debug mode.\n\n# Bug Fixes\n\n* Kits can now specify required prerequisites via hook.\n\n  Although the prereqs hook was documented, it was only partially\n  implemented.  This commit completes that implementation, so that if\n  `hooks/prereqs` exists in a kit, it will be run prior to usage.\n\n* Fix bug where default config type was lost when fetching configs from BOSH\n  director, resulting in bad messages and error reports.\n\n* Export `GENESIS_EXODUS_MOUNT` to hooks environment.  This was missing from the\n  set of vault path environment variables available to hook scripts.\n\n# Internal Changes/Improvements\n\n## BOSH Refactor\n\n* Add `Genesis::BOSH` for controlling BOSH director.\n\n  This is a major refactor to facilitate better operation and connections\n  to BOSH directors.  Connections to Bosh will use exodus data to\n  determine the corresponding BOSH director address and connection\n  details.\n\n* Set `GENESIS_BOSH_COMMAND` when checking BOSH cmd\n\n  Also removes `check_bosh_version` subroutine that was replaced by\n  `Genesis::BOSH#command`\n\n* Change `needs_bosh_create_env` to `use_create_env`\n\n## Functionality Improvement\n\n* Allow `Genesis::Kit#metadata` to take args.\n\n  If Genesis::Kit#metadata receives no arguments, it will return a hash\n  reference for all metadata for the kit.  If it gets a single value, it\n  returns the metadata corresponding to the key of that value.  Finally,\n  if it gets a list of values, it will return a list of the metadata\n  corresponding to the keys of the given values.\n\n## Efficiencies\n\n* Lazy-load kit provider types as needed.\n\n  By using `require` instead of `use` for loading the\n  `Genesis::Kit::Provider::*` classes, they are loaded as needed during\n  runtime instead of fully loaded at compile-time.\n\n* Memoize `Genesis::Env` `params` and `actual_environment_files`.\n\n## Structure / Maintainability\n\n* Reordered `lib/Genesis/Env.pm`, with folding and grouping.\n\n  This is done to be consistent with the other lib files.  No actual code\n  changed in this release, but the diff is massive because blocks were\n  moved into logical groupings.\n\n* Privatized `Genesis::Env#validate_name`.\n\n  `validate_name` method should only be used internally, so it was renamed\n  `_validate_env_name`.\n\n* Fixes inconsistant private variable naming.\n\n  * `_configs` has been changed to `__configs` in `Genesis::Env`, to match all\n    other private instance variables.\n",
      "url": "https://github.com/starkandwayne/genesis/releases/tag/v2.8.0",
      "version": "2.8.0"
    },
    {
      "notes": "# Bug Fixes\n\n* Genesis v2.8.0 reworked how Genesis interacted with BOSH, getting the\n  login information from exodus data.  However, when the exodus data is\n  not available, it lost its ability to specify the BOSH connectivity\n  via environment variables.  This has now been resolved.\n\n* Fixes error `Can't locate object method \"from_envvars\" via package\n  \"Genesis::BOSH::Director\"` when generating new genesis environment.\n\n* Fixes error when running `genesis bosh -h`, documents how to get help\n  for bosh commands instead of help for `genesis bosh`\n",
      "url": "https://github.com/starkandwayne/genesis/releases/tag/v2.8.1",
      "version": "2.8.1"
    },
    {
      "notes": "# Bug Fixes\n\n* Replaces error `Can't call method \"execute\" on an undefined value`\n  with more useful information on why BOSH director cannot be accessed.\n\n* Suppress repetitive deprecation messages for the environment when\n  processing various genesis commands.\n\n* The existing bosh wrapper function in Genesis::Helpers was not\n  compatible with the Genesis v2.8 internals regarding BOSH connectivity.\n  If the environment file exists, helpers will simply use `genesis bosh\n  ...` calls to make it Just Work™.  For the rare situation where the\n  enviroment file doesn't exist, a much more complicated validation and\n  connectivity routine is employed.\n\n* When generating the BOSH director for an environment, and is using the\n  environment variables to determine the BOSH director configuration, make\n  sure to set the deployment name.\n\n# Kit Authoring Improvements\n\n* Added `version_check` bash function to check that the version of Genesis\n  meets or exceeds your hook's required version.  If you use this, make sure\n  your kit specifies `genesis_version_minimum` of 2.8.2.\n\n* Improvements to `genesis compile-kit` interface and functionality:\n\n  - Now creates a local rc release when no version is specified, for the\n    next patch level above the highest remote or local version found.\n\n  - Can specify --target|-t to have the compiled kit placed in the\n    desired directory.  If the directory is a genesis repo, it will\n    place it under the directory's .genesis/kits path.\n\n  - When using -v <version>, if that version already exists locally or\n    remotely, it will error out to prevent reissuing different contents\n    under the same version (--force can be used to overcome this\n    limitation).\n\n  - When not specifying the explicit version, you can bump the major or\n    minor version instead of the path by using --major|-M or --minor|-m\n    options.  The --final option will create the next version without a\n    -rc# component.\n\n  - Improved feedback while processing.\n",
      "url": "https://github.com/starkandwayne/genesis/releases/tag/v2.8.2",
      "version": "2.8.2"
    }
  ],
  "latest": "2.8.2"
}
